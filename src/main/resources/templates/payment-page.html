<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Car Insurance Plan</title>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />

    <!-- html2pdf Library for PDF Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        body {
          font-family: 'Inter', sans-serif;
          background: linear-gradient(to right, #c2e9fb, #a1c4fd);
          display: flex;
          height: 100vh;
          overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
          width: 280px;
          background: rgba(0, 0, 0, 0.5);
          backdrop-filter: blur(12px);
          padding: 30px 20px;
          color: #fff;
          display: flex;
          flex-direction: column;
          gap: 16px;
          box-shadow: 6px 0 18px rgba(0, 0, 0, 0.2);
          animation: slideInLeft 1s ease-in-out forwards;
        }

        .sidebar h3 {
          font-size: 22px;
          margin-bottom: 12px;
          font-weight: 700;
          border-bottom: 2px solid #ffeb3b;
          padding-bottom: 6px;
        }

        .sidebar-item {
          background: rgba(255, 255, 255, 0.1);
          padding: 12px 16px;
          border-radius: 10px;
          font-size: 14px;
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-weight: 600;
          letter-spacing: 0.02em;
        }

        .sidebar-item span {
          color: #ffeb3b;
          font-weight: 700;
        }

        /* Main Content */
        .main-content {
          flex: 1;
          overflow-y: auto;
          padding: 40px;
          animation: fadeInUp 1s ease-in-out forwards;
          background: rgba(255, 255, 255, 0.85);
          box-shadow: 0 0 40px rgba(33, 150, 243, 0.2);
          border-radius: 20px;
          margin: 20px;
        }

        .form-container,
        .receipt-container {
          max-width: 700px;
          margin: auto;
          padding: 30px;
          background: white;
          border-radius: 20px;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
          animation: fadeInUp 1.2s ease-in-out;
        }

        h2,
        h3 {
          margin-bottom: 20px;
          color: #222;
          font-weight: 700;
          text-align: center;
          letter-spacing: 0.03em;
        }

        .form-group {
          margin-bottom: 18px;
        }

        label {
          font-weight: 600;
          display: block;
          margin-bottom: 6px;
          color: #333;
          letter-spacing: 0.02em;
        }

        input,
        select {
          width: 100%;
          padding: 12px 15px;
          border-radius: 12px;
          border: 1.8px solid #ccc;
          font-size: 1rem;
          outline: none;
          transition: 0.3s ease;
          font-family: 'Inter', sans-serif;
        }

        input:focus,
        select:focus {
          border-color: #0056d2;
          box-shadow: 0 0 10px rgba(0, 86, 210, 0.3);
        }

        .price-display {
          background: #e3f2fd;
          padding: 12px;
          border-radius: 10px;
          font-weight: 600;
          border: 1px dashed #2196f3;
          margin-top: 12px;
          animation: pulse 1.5s infinite alternate;
          text-align: center;
          color: #0d47a1;
        }

        .btn {
          background: linear-gradient(to right, #2196f3, #0d47a1);
          color: white;
          border: none;
          padding: 14px 32px;
          font-size: 16px;
          font-weight: 600;
          border-radius: 30px;
          cursor: pointer;
          margin-top: 20px;
          transition: transform 0.3s ease, box-shadow 0.3s ease;
          display: inline-block;
          box-shadow: 0 4px 15px rgba(33, 150, 243, 0.4);
          user-select: none;
        }

        .btn:hover {
          transform: scale(1.05);
          box-shadow: 0 6px 20px rgba(33, 150, 243, 0.6);
        }

        .btn:active {
          transform: scale(0.98);
        }

        .btn-red {
          background: #e53935;
          box-shadow: 0 4px 15px rgba(229, 57, 53, 0.5);
        }

        .btn-red:hover {
          box-shadow: 0 6px 20px rgba(229, 57, 53, 0.8);
        }

        .receipt {
          font-size: 1rem;
          line-height: 1.6;
          color: #222;
          user-select: text;
        }

        .receipt p {
          margin-bottom: 10px;
          word-break: break-word;
        }

        .receipt table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 16px;
        }

        .receipt th,
        .receipt td {
          border: 1px solid #ccc;
          padding: 10px;
          text-align: left;
        }

        .receipt th {
          background: #bbdefb;
          font-weight: 700;
          color: #0d47a1;
        }

        .receipt .total-row {
          background: #90caf9;
          font-weight: 700;
          color: #0d47a1;
        }

        @keyframes slideInLeft {
          from {
            transform: translateX(-100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }

        @keyframes fadeInUp {
          from {
            transform: translateY(40px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }

        @keyframes pulse {
          from {
            transform: scale(1);
          }
          to {
            transform: scale(1.03);
          }
        }

        /* Scrollbar Styling */
        .main-content::-webkit-scrollbar {
          width: 10px;
        }
        .main-content::-webkit-scrollbar-track {
          background: transparent;
        }
        .main-content::-webkit-scrollbar-thumb {
          background-color: #2196f3;
          border-radius: 20px;
        }

        /* Responsive */
        @media (max-width: 900px) {
          body {
            flex-direction: column;
            height: auto;
          }
          .sidebar {
            width: 100%;
            flex-direction: row;
            overflow-x: auto;
            padding: 15px;
            box-shadow: none;
            backdrop-filter: none;
          }
          .sidebar-item {
            flex: 1 0 130px;
            font-size: 13px;
          }
          .main-content {
            padding: 20px;
            margin: 0;
            border-radius: 0;
          }
          .form-container, .receipt-container {
            max-width: 100%;
            padding: 20px;
            border-radius: 0;
            box-shadow: none;
          }
        }
    </style>
</head>
<body>
<div class="sidebar">
    <h3>Your Info</h3>
    <div class="sidebar-item">Reg No: <span id="regInfo">-</span></div>
    <div class="sidebar-item">Brand: <span id="brandInfo">-</span></div>
    <div class="sidebar-item">Model: <span id="modelInfo">-</span></div>
    <div class="sidebar-item">Plan: <span id="planInfo">-</span></div>
    <div class="sidebar-item">Price: <span id="priceInfo">-</span></div>
    <div class="sidebar-item">Name: <span id="NameInfo">-</span></div>
    <div class="sidebar-item">Phone: <span id="PhonenoInfo">-</span></div>
    <div class="sidebar-item">Email: <span id="EmailInfo">-</span></div>
</div>

<div class="main-content">
    <div class="form-container" id="formContainer">
        <h2>ðŸš— Car Insurance Details</h2>
        <div class="form-group"><label for="regNumber">Vehicle Registration Number</label><input type="text" id="regNumber" autocomplete="off" /></div>
        <div class="form-group"><label for="brand">Car Brand</label><input type="text" id="brand" autocomplete="off" /></div>
        <div class="form-group"><label for="model">Car Model</label><input type="text" id="model" autocomplete="off" /></div>
        <div class="form-group">
            <label for="plan">Choose Insurance Plan</label>
            <select id="plan" autocomplete="off">
                <option value="">Select Plan</option>
                <option value="Premium">SBI General Insurance</option>
                <option value="Premium">ICICI Lombard</option>
                <option value="Premium">Reliance General</option>
                <option value="Premium">National Insurance</option>
                <option value="Premium">Royal Sundaram</option>
            </select>
            <div class="price-display" id="priceDisplay">Plan Price: - | GST: - | Final: -</div>
        </div>
        <div class="form-group"><label for="ownerName">Owner Name</label><input type="text" id="ownerName" autocomplete="off" /></div>
        <div class="form-group"><label for="contactNumber">Phone Number</label><input type="tel" id="contactNumber" pattern="[0-9]{10}" autocomplete="off" /></div>
        <div class="form-group"><label for="emailAddress">Email Address</label><input type="email" id="emailAddress" autocomplete="off" /></div>
        <button class="btn" id="generateBtn" type="button">Apply</button>
    </div>

    <div class="receipt-container" id="receiptContainer" style="display:none;">
        <h3>ðŸ“ƒ Insurance Receipt</h3>
        <div class="receipt" id="receiptContent"></div>
        <div style="margin-top: 20px; text-align: center;">
            <button class="btn" id="printBtn" type="button">ðŸ–¨ Print</button>
            <button class="btn" id="pdfBtn" type="button">ðŸ“„ Download PDF</button>
            <button class="btn btn-red" id="backBtn" type="button">â¬… Back</button>
        </div>
    </div>
</div>

<script>
    const regInput = document.getElementById('regNumber');
    const brandInput = document.getElementById('brand');
    const modelInput = document.getElementById('model');
    const planSelect = document.getElementById('plan');
    const ownerInput = document.getElementById('ownerName');
    const contactInput = document.getElementById('contactNumber');
    const emailInput = document.getElementById('emailAddress');

    const regInfo = document.getElementById('regInfo');
    const brandInfo = document.getElementById('brandInfo');
    const modelInfo = document.getElementById('modelInfo');
    const planInfo = document.getElementById('planInfo');
    const priceInfo = document.getElementById('priceInfo');
    const nameInfo = document.getElementById('NameInfo');
    const phoneInfo = document.getElementById('PhonenoInfo');
    const emailInfo = document.getElementById('EmailInfo');

    const priceDisplay = document.getElementById('priceDisplay');
    const generateBtn = document.getElementById('generateBtn');
    const printBtn = document.getElementById('printBtn');
    const backBtn = document.getElementById('backBtn');
    const pdfBtn = document.getElementById('pdfBtn');
    const formContainer = document.getElementById('formContainer');
    const receiptContainer = document.getElementById('receiptContainer');
    const receiptContent = document.getElementById('receiptContent');

    // Fixed price for all Premium plans (same pricing for all as per original code)
    const planPricing = {
      Premium: 714
    };

    function updateSidebar() {
      regInfo.textContent = regInput.value.trim() || '-';
      brandInfo.textContent = brandInput.value.trim() || '-';
      modelInfo.textContent = modelInput.value.trim() || '-';
      const selectedPlanText = planSelect.options[planSelect.selectedIndex]?.text || '-';
      planInfo.textContent = selectedPlanText;
      nameInfo.textContent = ownerInput.value.trim() || '-';
      phoneInfo.textContent = contactInput.value.trim() || '-';
      emailInfo.textContent = emailInput.value.trim() || '-';
      updatePriceDisplay();
    }

    function updatePriceDisplay() {
      const plan = planSelect.value;
      if (!plan || !planPricing[plan]) {
        priceDisplay.textContent = "Plan Price: - | GST: - | Final: -";
        priceInfo.textContent = "-";
        return;
      }
      const price = planPricing[plan];
      const gst = +(price * 0.18).toFixed(2);
      const final = +(price + gst).toFixed(2);
      priceDisplay.textContent = `Plan Price: â‚¹${price.toLocaleString()} | GST: â‚¹${gst} | Final: â‚¹${final}`;
      priceInfo.textContent = `â‚¹${final}`;
    }

    [regInput, brandInput, modelInput, planSelect, ownerInput, contactInput, emailInput].forEach(el => {
      el.addEventListener('input', updateSidebar);
    });

    generateBtn.addEventListener('click', () => {
      if (!regInput.value.trim() || !brandInput.value.trim() || !modelInput.value.trim() ||
        !planSelect.value || !ownerInput.value.trim() ||
        !contactInput.value.trim() || !emailInput.value.trim()) {
        alert("Please fill all fields.");
        return;
      }

      // Basic phone number validation
      if (!/^\d{10}$/.test(contactInput.value.trim())) {
        alert("Please enter a valid 10-digit phone number.");
        return;
      }

      // Basic email validation (HTML5 type=email also helps)
      if (!emailInput.checkValidity()) {
        alert("Please enter a valid email address.");
        return;
      }

      const plan = planSelect.value;
      const price = planPricing[plan];
      const gst = +(price * 0.18).toFixed(2);
      const final = +(price + gst).toFixed(2);
      const planName = planSelect.options[planSelect.selectedIndex].text;

      receiptContent.innerHTML = `
        <p><strong>Registration No:</strong> ${regInput.value}</p>
        <p><strong>Car Brand:</strong> ${brandInput.value}</p>
        <p><strong>Car Model:</strong> ${modelInput.value}</p>
        <p><strong>Insurance Plan:</strong> ${planName}</p>
        <p><strong>Owner:</strong> ${ownerInput.value}</p>
        <p><strong>Phone:</strong> ${contactInput.value}</p>
        <p><strong>Email:</strong> ${emailInput.value}</p>

        <table>
          <tr><th>Description</th><th>Amount (â‚¹)</th></tr>
          <tr><td>Plan Price</td><td>${price}</td></tr>
          <tr><td>GST (18%)</td><td>${gst}</td></tr>
          <tr class="total-row"><td>Total Payable</td><td>${final}</td></tr>
        </table>
      `;

      receiptContainer.style.display = 'block';
      formContainer.style.display = 'none';
    });

    backBtn.addEventListener('click', () => {
      receiptContainer.style.display = 'none';
      formContainer.style.display = 'block';
    });

    printBtn.addEventListener('click', () => {
      window.print();
    });

    pdfBtn.addEventListener('click', () => {
      const element = document.getElementById('receiptContent');
      html2pdf().set({
        margin: 0.5,
        filename: 'car_insurance_receipt.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
      }).from(element).save();
    });

    updateSidebar();
</script>
</body>
</html>
